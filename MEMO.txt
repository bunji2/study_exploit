--------------------------------------------------------------------------

# ./check_canary AAAA
AAAA
# main canary = 0x64d56a00 (006ad564)
AAAA
# foo  canary = 0x64d56a00 (006ad564)
AAAA
# bar  canary = 0x64d56a00 (006ad564)
AAAA
# foo  canary = 0x64d56a00 (006ad564)


# ./check_canary $(python -c "print 'A'*100")
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# main canary = 0xa4e37600 (0076e3a4)
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# foo  canary = 0xa4e37600 (0076e3a4)
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# bar  canary = 0xa4e37600 (0076e3a4)
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# foo  canary = 0xa4e37600 (0076e3a4)


# ./check_canary $(python -c "print 'A'*101")
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# main canary = 0x16c60041 (4100c616)
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# foo  canary = 0x16c60041 (4100c616)
*** stack smashing detected ***: ./check_canary terminated
======= Backtrace: =========
/lib/libc.so.6(__fortify_fail+0x45)[0xf76f4d65]
/lib/libc.so.6(+0x10fd1a)[0xf76f4d1a]
./check_canary[0x8048589]
./check_canary[0x804873a]
/lib/libc.so.6(__libc_start_main+0xf3)[0xf75fea43]
./check_canary[0x80483f1]
======= Memory map: ========
08048000-08049000 r-xp 00000000 fd:00 9214693                            /root/sometest/check_canary
08049000-0804a000 r--p 00000000 fd:00 9214693                            /root/sometest/check_canary
0804a000-0804b000 rw-p 00001000 fd:00 9214693                            /root/sometest/check_canary
08f73000-08f94000 rw-p 00000000 00:00 0                                  [heap]
f75c3000-f75dc000 r-xp 00000000 fd:00 4195515                            /usr/lib/libgcc_s-4.8.5-20150702.so.1
f75dc000-f75dd000 r--p 00018000 fd:00 4195515                            /usr/lib/libgcc_s-4.8.5-20150702.so.1
f75dd000-f75de000 rw-p 00019000 fd:00 4195515                            /usr/lib/libgcc_s-4.8.5-20150702.so.1
f75e4000-f75e5000 rw-p 00000000 00:00 0 
f75e5000-f779e000 r-xp 00000000 fd:00 4361443                            /usr/lib/libc-2.17.so
f779e000-f779f000 ---p 001b9000 fd:00 4361443                            /usr/lib/libc-2.17.so
f779f000-f77a1000 r--p 001b9000 fd:00 4361443                            /usr/lib/libc-2.17.so
f77a1000-f77a2000 rw-p 001bb000 fd:00 4361443                            /usr/lib/libc-2.17.so
f77a2000-f77a5000 rw-p 00000000 00:00 0 
f77a9000-f77ac000 rw-p 00000000 00:00 0 
f77ac000-f77cd000 r-xp 00000000 fd:00 4529576                            /usr/lib/ld-2.17.so
f77cd000-f77ce000 r-xp 00000000 00:00 0                                  [vdso]
f77ce000-f77cf000 r--p 00021000 fd:00 4529576                            /usr/lib/ld-2.17.so
f77cf000-f77d0000 rw-p 00022000 fd:00 4529576                            /usr/lib/ld-2.17.so
ff976000-ff997000 rw-p 00000000 00:00 0                                  [stack]

--------------------
ASLR

# sysctl -w kernel.randomize_va_space=2
# ./check_addr AAAA
addr of main   = 0x80484dd
addr of buf    = 0xffdfc1c8
addr of strcpy = 0x80483a0
addr of printf = 0x8048380
addr of puts   = 0x80483b0
AAAA
[root@redhare sometest]# ./check_addr AAAA
addr of main   = 0x80484dd
addr of buf    = 0xff91e328
addr of strcpy = 0x80483a0
addr of printf = 0x8048380
addr of puts   = 0x80483b0
AAAA
[root@redhare sometest]# ./check_addr AAAA
addr of main   = 0x80484dd
addr of buf    = 0xff8bc758
addr of strcpy = 0x80483a0
addr of printf = 0x8048380
addr of puts   = 0x80483b0
AAAA
[root@redhare sometest]# ./check_addr AAAA
addr of main   = 0x80484dd
addr of buf    = 0xff7fc598
addr of strcpy = 0x80483a0
addr of printf = 0x8048380
addr of puts   = 0x80483b0
AAAA
[root@redhare sometest]# ./check_addr AAAA
addr of main   = 0x80484dd
addr of buf    = 0xffdfdba8
addr of strcpy = 0x80483a0
addr of printf = 0x8048380
addr of puts   = 0x80483b0
AAAA

